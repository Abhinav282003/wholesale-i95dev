{{ 'quick-order-list.css' | asset_url | stylesheet_tag }}
<script>
  window.customerId = {{ customer.id | default: 'null' | json }};
  console.log('üè™ Customer ID set:', window.customerId);
</script>
{{ 'persistent-cart.js' | asset_url | script_tag }}
<div class="quick-order-list page-width">
   {% render 'search-controls' %}

    <form method="post" action="/cart" class="quick-order-form" id="quick-order-form">
      <div class="quick-order-table-wrapper">
        <div class="quick-order-table">
          {% render 'table-header' %}
          <div class="table-body" id="product-table-body">
             {% assign collection = collections['all'] %}
             {% assign products_per_page = 5 %}
             {% assign total_products = collection.products.size %}
             {% assign total_pages = total_products | divided_by: products_per_page | ceil %}
             
                          {% for product in collection.products limit:10 %}
               <div class="table-row product-row" data-product-title="{{ product.title | downcase }}" data-product-sku="{{ product.selected_or_first_available_variant.sku | downcase }}" data-collections="{% for collection in product.collections %}{{ collection.handle }} {% endfor %}" data-product-id="{{ product.id }}" data-page="{% assign page_number = forloop.index0 | divided_by: products_per_page | plus: 1 %}{{ page_number }}">
                <div class="table-cell image-column">
                  <div class="product-image">
                    {% if product.featured_image %}
                      <img src="{{ product.featured_image | img_url: '100x100', crop: 'center' }}" alt="{{ product.title }}" loading="lazy">
                    {% else %}
                      <img src="{{ 'no-image.png' | asset_url }}" alt="{{ product.title }}" loading="lazy" class="placeholder-image">
                    {% endif %}
                  </div>
                </div>
                <div class="table-cell product-column">
                  <div class="product-info">
                    <div class="product-details">
                      <a href="{{ product.url }}" class="product-title">{{ product.title }}</a>
                      {% if product.vendor %}
                        <p class="product-vendor">{{ product.vendor }}</p>
                      {% endif %}
                      {% if product.has_only_default_variant == false %}
                        <div class="variant-toggle">
                          <button type="button" class="variant-toggle-btn" data-product-id="{{ product.id }}">
                            <span class="toggle-text">Show Variants</span>
                            <span class="toggle-icon">‚ñº</span>
                          </button>
                        </div>
                      {% endif %}
                    </div>
                  </div>
                </div>
                                 <div class="table-cell price-column">
                   {% if product.has_only_default_variant %}
                     {% assign first_variant = product.variants.first %}
                     <span class="price" data-price="{{ first_variant.price }}">{{ first_variant.price | money }}</span>
                   {% else %}
                     <span class="price-range">Multiple Prices</span>
                   {% endif %}
                 </div>
                <div class="table-cell quantity-column">
                  {% if product.has_only_default_variant %}
                    {% assign first_variant = product.variants.first %}
                    <div class="quantity-wrapper">
                      <input 
                        tabindex="0" 
                        class="quantity field qty-input" 
                        id="{{ first_variant.id }}" 
                        step="1" 
                        pattern="^-?\d+$" 
                        product-id="{{ product.id }}" 
                        type="number" 
                        name="updates[{{ first_variant.id }}]" 
                        onfocus="this.select()" 
                        min="0" 
                        value="0"
                        data-variant-id="{{ first_variant.id }}"
                        data-variant-sku="{{ first_variant.sku }}"
                        {% unless first_variant.available %}disabled{% endunless %}
                      >
                    </div>
                  {% else %}
                    <span class="variant-required">Select Variant</span>
                  {% endif %}
                </div>
                <div class="table-cell total-column">
                  {% if product.has_only_default_variant %}
                    <span class="row-total price">Rs 0.00</span>
                  {% else %}
                    <span class="row-total price">Rs 0.00</span>
                  {% endif %}
                </div>
              </div>
              
              {% if product.has_only_default_variant == false %}
                <div class="variant-rows" data-product-id="{{ product.id }}" style="display: none;">
                  {% for variant in product.variants %}
                                         <div class="table-row variant-row" data-variant-id="{{ variant.id }}" data-variant-sku="{{ variant.sku | downcase }}" data-price="{{ variant.price }}">
                      <div class="table-cell image-column">
                        <div class="variant-indicator">‚îî‚îÄ</div>
                      </div>
                      <div class="table-cell product-column">
                        <div class="variant-info">
                          <span class="variant-title">
                            {% if variant.title != 'Default Title' %}
                              {{ variant.title }}
                            {% else %}
                              Default
                            {% endif %}
                          </span>
                          {% unless variant.available %}
                            <span class="sold-out-badge">Sold out</span>
                          {% endunless %}
                        </div>
                      </div>
                                             <div class="table-cell price-column">
                         <span class="price" data-price="{{ variant.price }}">{{ variant.price | money }}</span>
                       </div>
                      <div class="table-cell quantity-column">
                        <div class="quantity-wrapper">
                          <input 
                            tabindex="0" 
                            class="quantity field qty-input" 
                            id="{{ variant.id }}" 
                            step="1" 
                            pattern="^-?\d+$" 
                            product-id="{{ product.id }}" 
                            type="number" 
                            name="updates[{{ variant.id }}]" 
                            onfocus="this.select()" 
                            min="0" 
                            value="0"
                            data-variant-id="{{ variant.id }}"
                            data-variant-sku="{{ variant.sku }}"
                            {% unless variant.available %}disabled{% endunless %}
                          >
                        </div>
                      </div>
                      <div class="table-cell total-column">
                        <span class="row-total price">Rs 0.00</span>
                      </div>
                    </div>
                  {% endfor %}
                </div>
              {% endif %}
            {% endfor %}
          </div>
                 </div>
       </div>
 
       {% render 'cart-summary' %}
       {% render 'pagination-controls' %}

     <div class="quick-order-actions">
       <button type="submit" class="button button--primary" id="view-cart-btn-1">
         <span>View cart</span>
       </button>
     </div>
   </form>
</div>
